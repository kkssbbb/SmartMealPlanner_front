{"ast":null,"code":"import{weightLossProducts,muscleGainProducts,maintenanceProducts}from'../data/mockProducts';import{getRecipesByGoal,calculateRecipeNutrition,getRecipeIngredients}from'../data/recipeData';// ğŸ¯ ê°œì¸í™” ì¶”ì²œ ì»¨í…ìŠ¤íŠ¸\n// ğŸ§® ì‚¬ìš©ìë³„ ë§ì¶¤ ì˜ì–‘ì†Œ ëª©í‘œ ê³„ì‚°\nexport const calculatePersonalizedNutritionTargets=(userProfile,calorieCalculation)=>{const{goal,weight,height,age,gender}=userProfile;const{targetCalories}=calorieCalculation;// ëª©í‘œë³„ ë‹¨ë°±ì§ˆ í•„ìš”ëŸ‰ (ì²´ì¤‘ 1kgë‹¹)\nconst proteinPerKg={weight_loss:1.6,// ë‹¤ì´ì–´íŠ¸: ê·¼ì†ì‹¤ ë°©ì§€ë¥¼ ìœ„í•´ ë†’ì€ ë‹¨ë°±ì§ˆ\nmaintenance:1.2,// ìœ ì§€: ì¼ë°˜ ê¶Œì¥ëŸ‰\nmuscle_gain:1.8// ê·¼ì„±ì¥: ë†’ì€ ë‹¨ë°±ì§ˆ í•„ìš”\n};// ê°œì¸ë³„ ë‹¨ë°±ì§ˆ í•„ìš”ëŸ‰ ê³„ì‚°\nconst dailyProteinNeeds=weight*proteinPerKg[goal];const proteinCalories=dailyProteinNeeds*4;const proteinPercentage=proteinCalories/targetCalories*100;// ëª©í‘œë³„ ì§€ë°© ë¹„ìœ¨ ì¡°ì •\nconst fatPercentage={weight_loss:20,// ë‹¤ì´ì–´íŠ¸: ë‚®ì€ ì§€ë°©\nmaintenance:30,// ìœ ì§€: ê· í˜•\nmuscle_gain:25// ê·¼ì„±ì¥: ì¤‘ê°„ ì§€ë°©\n}[goal];// ë‚˜ë¨¸ì§€ëŠ” íƒ„ìˆ˜í™”ë¬¼\nconst carbPercentage=100-proteinPercentage-fatPercentage;return{targetCalories,dailyProteinNeeds,macroPercentages:{protein:Math.max(15,Math.min(35,proteinPercentage)),// 15-35% ë²”ìœ„\nfat:fatPercentage,carb:Math.max(30,carbPercentage)// ìµœì†Œ 30%\n},macroGrams:{protein:dailyProteinNeeds,fat:targetCalories*fatPercentage/100/9,carb:targetCalories*carbPercentage/100/4}};};// ğŸ¯ ìŠ¤ë§ˆíŠ¸ ì œí’ˆ ì¶”ì²œ ì—”ì§„\nexport const getPersonalizedProductRecommendations=context=>{const{userProfile,calorieCalculation}=context;const nutritionTargets=calculatePersonalizedNutritionTargets(userProfile,calorieCalculation);// ëª©í‘œë³„ ê¸°ë³¸ ì œí’ˆêµ° ì„ íƒ\nlet candidateProducts=[];switch(userProfile.goal){case'weight_loss':candidateProducts=[...weightLossProducts,...maintenanceProducts.filter(p=>p.nutrition.calories<150)];break;case'muscle_gain':candidateProducts=[...muscleGainProducts,...maintenanceProducts.filter(p=>p.nutrition.protein>15)];break;case'maintenance':default:candidateProducts=[...maintenanceProducts,...weightLossProducts.slice(0,2)];break;}// ì˜ˆì‚° í•„í„°ë§ (ë” í˜„ì‹¤ì ì¸ ì ‘ê·¼)\nconst dailyBudget=userProfile.budget/30;// ì¼ì¼ ì˜ˆì‚°\nconst mealBudget=dailyBudget/3;// ë¼ë‹ˆë‹¹ ì˜ˆì‚°\nconst affordableProducts=candidateProducts.filter(product=>{// 1ì£¼ì¼ì¹˜ êµ¬ë§¤ ì‹œ ë¼ë‹ˆë‹¹ ë¹„ìš© ê³„ì‚°\nconst productDuration=getProductDuration(product);const costPerMeal=product.price/productDuration/3;return costPerMeal<=mealBudget*2;// ì˜ˆì‚°ì˜ 200%ê¹Œì§€ í—ˆìš©\n});// ì˜ì–‘ì†Œ ì í•©ì„± ì ìˆ˜ ê³„ì‚°\nconst scoredProducts=affordableProducts.map(product=>({product,score:calculateAdvancedNutrientScore(product,nutritionTargets,context)}));// ì ìˆ˜ìˆœ ì •ë ¬ ë° ë‹¤ì–‘ì„± ë³´ì¥\nconst sortedProducts=scoredProducts.sort((a,b)=>b.score-a.score).slice(0,20);// ìƒìœ„ 20ê°œ ì„ ë³„\n// ì¹´í…Œê³ ë¦¬ë³„ ë‹¤ì–‘ì„± ë³´ì¥\nconst diverseProducts=ensureProductDiversity(sortedProducts.map(sp=>sp.product));return diverseProducts.slice(0,12);};// ğŸ³ ìŠ¤ë§ˆíŠ¸ ë ˆì‹œí”¼ ì¶”ì²œ ì—”ì§„\nexport const getPersonalizedRecipeRecommendations=async context=>{const{userProfile}=context;const baseRecipes=await getRecipesByGoal(userProfile.goal);// ì‹œê°„ëŒ€ë³„ í•„í„°ë§\nconst currentHour=context.currentTime.getHours();let mealType;if(currentHour<11)mealType='breakfast';else if(currentHour<17)mealType='lunch';else mealType='dinner';// ì‚¬ìš©ì ì„ í˜¸ë„ ë°˜ì˜\nlet filteredRecipes=baseRecipes.filter(recipe=>{var _context$preferences,_context$preferences2,_context$preferences3;// ì‹œê°„ëŒ€ ë§ì¶¤\nif(recipe.mealType!==mealType)return false;// ì¡°ë¦¬ì‹œê°„ ì„ í˜¸ë„\nif(((_context$preferences=context.preferences)===null||_context$preferences===void 0?void 0:_context$preferences.cookingTime)==='quick'&&recipe.cookingTime>15)return false;if(((_context$preferences2=context.preferences)===null||_context$preferences2===void 0?void 0:_context$preferences2.cookingTime)==='slow'&&recipe.cookingTime<20)return false;// ë‚œì´ë„ ì„ í˜¸ë„\nif((_context$preferences3=context.preferences)!==null&&_context$preferences3!==void 0&&_context$preferences3.difficulty&&recipe.difficulty!==context.preferences.difficulty){return false;}return true;});// ì˜ì–‘ ëª©í‘œì— ë§ëŠ” ë ˆì‹œí”¼ ì ìˆ˜ ê³„ì‚°\nconst nutritionTargets=calculatePersonalizedNutritionTargets(userProfile,context.calorieCalculation);const scoredRecipes=filteredRecipes.map(recipe=>({recipe,score:calculateRecipePersonalizationScore(recipe,nutritionTargets,context)}));// ì ìˆ˜ìˆœ ì •ë ¬\nreturn scoredRecipes.sort((a,b)=>b.score-a.score).map(sr=>sr.recipe).slice(0,6);};// ğŸ¯ ê³ ê¸‰ ì˜ì–‘ì†Œ ì ìˆ˜ ê³„ì‚°\nconst calculateAdvancedNutrientScore=(product,targets,context)=>{let score=0;const nutrition=product.nutrition;// ëª©í‘œ ì¹¼ë¡œë¦¬ ëŒ€ë¹„ ì í•©ì„± (30%)\nconst calorieRatio=nutrition.calories/targets.targetCalories*100;if(calorieRatio>5&&calorieRatio<25)score+=30;else if(calorieRatio<=5)score+=20;// ë‹¨ë°±ì§ˆ í•¨ëŸ‰ í‰ê°€ (25%)\nif(context.userProfile.goal==='weight_loss'||context.userProfile.goal==='muscle_gain'){if(nutrition.protein>20)score+=25;else if(nutrition.protein>15)score+=20;else if(nutrition.protein>10)score+=10;}else{if(nutrition.protein>5)score+=25;}// ì§€ë°© í•¨ëŸ‰ í‰ê°€ (20%)\nconst fatRatio=nutrition.fat*9/nutrition.calories*100;if(context.userProfile.goal==='weight_loss'&&fatRatio<30)score+=20;else if(context.userProfile.goal==='muscle_gain'&&fatRatio>20&&fatRatio<40)score+=20;else if(context.userProfile.goal==='maintenance'&&fatRatio>25&&fatRatio<35)score+=20;// ë‚˜íŠ¸ë¥¨ í•¨ëŸ‰ í‰ê°€ (15%)\nif(nutrition.sodium<300)score+=15;else if(nutrition.sodium<500)score+=10;else if(nutrition.sodium<800)score+=5;// ê°€ê²© ëŒ€ë¹„ ì˜ì–‘ê°€ (10%)\nconst nutritionValue=nutrition.protein*4+nutrition.carb*4+nutrition.fat*9;const pricePerNutrition=product.price/nutritionValue;if(pricePerNutrition<50)score+=10;else if(pricePerNutrition<100)score+=5;return Math.min(100,score);};// ğŸ³ ë ˆì‹œí”¼ ê°œì¸í™” ì ìˆ˜ ê³„ì‚°\nconst calculateRecipePersonalizationScore=(recipe,targets,context)=>{var _context$preferences4,_context$preferences5,_context$preferences6,_context$preferences7,_context$history;let score=0;// ëª©í‘œ ì í•©ì„± (40%)\nif(recipe.goalFit.includes(context.userProfile.goal))score+=40;// ì¡°ë¦¬ì‹œê°„ ì í•©ì„± (20%)\nif(((_context$preferences4=context.preferences)===null||_context$preferences4===void 0?void 0:_context$preferences4.cookingTime)==='quick'&&recipe.cookingTime<=15)score+=20;else if(((_context$preferences5=context.preferences)===null||_context$preferences5===void 0?void 0:_context$preferences5.cookingTime)==='normal'&&recipe.cookingTime<=30)score+=20;else if(((_context$preferences6=context.preferences)===null||_context$preferences6===void 0?void 0:_context$preferences6.cookingTime)==='slow'&&recipe.cookingTime>30)score+=20;else score+=10;// ë‚œì´ë„ ì í•©ì„± (15%)\nif(((_context$preferences7=context.preferences)===null||_context$preferences7===void 0?void 0:_context$preferences7.difficulty)===recipe.difficulty)score+=15;else score+=5;// ì˜ì–‘ì†Œ ê· í˜• (15%)\nconst recipeNutrition=calculateRecipeNutrition(recipe.id);if(recipeNutrition.calories>0){const proteinRatio=recipeNutrition.protein*4/recipeNutrition.calories*100;const targetProteinRatio=targets.macroPercentages.protein;if(Math.abs(proteinRatio-targetProteinRatio)<10)score+=15;else if(Math.abs(proteinRatio-targetProteinRatio)<20)score+=10;}// ìµœê·¼ ì¡°ë¦¬ ì´ë ¥ (10%) - ë‹¤ì–‘ì„± ë³´ì¥\nif((_context$history=context.history)!==null&&_context$history!==void 0&&_context$history.cookedRecipes&&!context.history.cookedRecipes.includes(recipe.id)){score+=10;}else{score+=5;}return Math.min(100,score);};// ğŸ›¡ï¸ ì œí’ˆ ë‹¤ì–‘ì„± ë³´ì¥\nconst ensureProductDiversity=products=>{const categorySet=new Set(products.map(p=>p.category));const categories=Array.from(categorySet);const diverseProducts=[];// ì¹´í…Œê³ ë¦¬ë³„ë¡œ ìµœì†Œ 1ê°œì”© ì„ íƒ\ncategories.forEach(category=>{const categoryProducts=products.filter(p=>p.category===category);if(categoryProducts.length>0){diverseProducts.push(categoryProducts[0]);}});// ë‚˜ë¨¸ì§€ ìë¦¬ëŠ” ì ìˆ˜ ìˆœìœ¼ë¡œ ì±„ìš°ê¸°\nconst remainingProducts=products.filter(p=>!diverseProducts.includes(p));diverseProducts.push(...remainingProducts.slice(0,12-diverseProducts.length));return diverseProducts;};// ğŸ“¦ ì œí’ˆ ì§€ì† ê¸°ê°„ ì¶”ì • (ì¼ ë‹¨ìœ„)\nconst getProductDuration=product=>{// ì œí’ˆëª…ê³¼ ìš©ëŸ‰ ì •ë³´ë¡œ ì§€ì† ê¸°ê°„ ì¶”ì •\nif(product.weight.includes('30íŒ©'))return 30;if(product.weight.includes('20ê°œ')||product.weight.includes('20íŒ©'))return 20;if(product.weight.includes('15íŒ©'))return 15;if(product.weight.includes('12ê°œ')||product.weight.includes('12íŒ©'))return 12;if(product.weight.includes('10íŒ©')||product.weight.includes('10ê°œ'))return 10;if(product.weight.includes('8íŒ©')||product.weight.includes('8ê°œ'))return 8;if(product.weight.includes('6ê°œ')||product.weight.includes('6íŒ©'))return 6;if(product.weight.includes('5kg'))return 20;// 5kg ì œí’ˆì€ ì•½ 20ì¼\nif(product.weight.includes('3kg'))return 15;// 3kg ì œí’ˆì€ ì•½ 15ì¼\nif(product.weight.includes('500g'))return 5;// 500g ì œí’ˆì€ ì•½ 5ì¼\nreturn 7;// ê¸°ë³¸ê°’: 1ì£¼ì¼\n};// ğŸ’° ë ˆì‹œí”¼ë³„ ì›”ê°„ ë¹„ìš© ê³„ì‚° (ì •í™•í•œ ê³„ì‚°)\nconst calculateRecipeMonthlyCost=function(recipeId){let monthlyFrequency=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;const ingredients=getRecipeIngredients(recipeId);let totalMonthlyCost=0;ingredients.forEach(ingredient=>{const product=ingredient.product;const productDuration=getProductDuration(product);// ì œí’ˆ ì§€ì† ê¸°ê°„ (ì¼)\nconst recipesPerProduct=productDuration;// í•œ ì œí’ˆìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë ˆì‹œí”¼ ìˆ˜\nconst costPerRecipe=product.price/recipesPerProduct;// ë ˆì‹œí”¼ 1íšŒë‹¹ ë¹„ìš©\nconst monthlyCost=costPerRecipe*monthlyFrequency;// ì›”ê°„ í•´ë‹¹ ì¬ë£Œ ë¹„ìš©\ntotalMonthlyCost+=monthlyCost;});return Math.round(totalMonthlyCost);};// ğŸ½ï¸ êµ¬ë§¤í•œ ì¬ë£Œë¡œ ë ˆì‹œí”¼ë¥¼ ëª‡ ë²ˆ í•´ë¨¹ì„ ìˆ˜ ìˆëŠ”ì§€ ê³„ì‚°\nexport const calculateRecipeFrequency=recipeId=>{const ingredients=getRecipeIngredients(recipeId);// recipes ë°°ì—´ì´ ì—†ìœ¼ë¯€ë¡œ ì„ì‹œ ë ˆì‹œí”¼ ì •ë³´ ì‚¬ìš©\nconst recipe={id:recipeId,name:\"\\uB808\\uC2DC\\uD53C \".concat(recipeId)};const ingredientAnalysis=ingredients.map(ingredient=>{const product=ingredient.product;// ğŸ“¦ ì •í™•í•œ ì œí’ˆ íŒ¨í‚¤ì§€ ë¶„ì„ (ì‹¤ì œ mock ë°ì´í„° ê¸°ì¤€)\nconst analyzePackage=packageInfo=>{console.log(\"\\uD83D\\uDD0D \\uD328\\uD0A4\\uC9C0 \\uBD84\\uC11D \\uC911: \\\"\".concat(packageInfo,\"\\\"\"));// ë””ë²„ê·¸ìš©\n// íŒ¨í„´: \"ë‹¨ìœ„ x ê°œìˆ˜\" í˜•íƒœ ë¶„ì„\n// 1ï¸âƒ£ \"100g x 30íŒ©\" í˜•íƒœ\nconst gramPackPattern=/(\\d+)g\\s*x\\s*(\\d+)/i;const gramPackMatch=packageInfo.match(gramPackPattern);if(gramPackMatch){const perPack=parseInt(gramPackMatch[1]);const packCount=parseInt(gramPackMatch[2]);console.log(\"\\uD83D\\uDCE6 \\uADF8\\uB7A8\\uD329: \".concat(perPack,\"g x \").concat(packCount,\"\\uD329 = \").concat(perPack*packCount,\"g\"));return{totalAmount:perPack*packCount,unitType:'g'};}// 2ï¸âƒ£ \"150g x 12ê°œ\" í˜•íƒœ  \nconst gramItemPattern=/(\\d+)g\\s*x\\s*(\\d+)ê°œ/i;const gramItemMatch=packageInfo.match(gramItemPattern);if(gramItemMatch){const perItem=parseInt(gramItemMatch[1]);const itemCount=parseInt(gramItemMatch[2]);console.log(\"\\uD83D\\uDCE6 \\uADF8\\uB7A8\\uAC1C\\uC218: \".concat(perItem,\"g x \").concat(itemCount,\"\\uAC1C = \").concat(perItem*itemCount,\"g\"));return{totalAmount:perItem*itemCount,unitType:'g'};}// 3ï¸âƒ£ \"5kg\" ë‹¨ì¼ í˜•íƒœ\nconst singleKgPattern=/(\\d+)kg/i;const singleKgMatch=packageInfo.match(singleKgPattern);if(singleKgMatch){const kg=parseInt(singleKgMatch[1]);console.log(\"\\uD83D\\uDCE6 \\uD0AC\\uB85C\\uADF8\\uB7A8: \".concat(kg,\"kg = \").concat(kg*1000,\"g\"));return{totalAmount:kg*1000,unitType:'g'};}// 4ï¸âƒ£ \"500g\" ë‹¨ì¼ í˜•íƒœ\nconst singleGramPattern=/(\\d+)g(?!\\s*x)/i;const singleGramMatch=packageInfo.match(singleGramPattern);if(singleGramMatch){const grams=parseInt(singleGramMatch[1]);console.log(\"\\uD83D\\uDCE6 \\uADF8\\uB7A8: \".concat(grams,\"g\"));return{totalAmount:grams,unitType:'g'};}// 5ï¸âƒ£ \"12ê°œ\" ë‹¨ì¼ ê°œìˆ˜ í˜•íƒœ\nconst singleCountPattern=/(\\d+)ê°œ(?!\\s*[Ã—x])/i;const singleCountMatch=packageInfo.match(singleCountPattern);if(singleCountMatch){const count=parseInt(singleCountMatch[1]);console.log(\"\\uD83D\\uDCE6 \\uAC1C\\uC218: \".concat(count,\"\\uAC1C\"));return{totalAmount:count,unitType:'ê°œ'};}// 6ï¸âƒ£ \"2L\" ë¦¬í„° í˜•íƒœ\nconst literPattern=/(\\d+(?:\\.\\d+)?)L/i;const literMatch=packageInfo.match(literPattern);if(literMatch){const liters=parseFloat(literMatch[1]);console.log(\"\\uD83D\\uDCE6 \\uB9AC\\uD130: \".concat(liters,\"L = \").concat(liters*1000,\"ml\"));return{totalAmount:liters*1000,unitType:'ml'};}// 7ï¸âƒ£ \"500ml\" ë°€ë¦¬ë¦¬í„° í˜•íƒœ\nconst mlPattern=/(\\d+)ml/i;const mlMatch=packageInfo.match(mlPattern);if(mlMatch){const ml=parseInt(mlMatch[1]);console.log(\"\\uD83D\\uDCE6 \\uBC00\\uB9AC\\uB9AC\\uD130: \".concat(ml,\"ml\"));return{totalAmount:ml,unitType:'ml'};}console.warn(\"\\u26A0\\uFE0F \\uD328\\uD0A4\\uC9C0 \\uC815\\uBCF4 \\uBD84\\uC11D \\uC2E4\\uD328: \\\"\".concat(packageInfo,\"\\\" - \\uAE30\\uBCF8\\uAC12 \\uC0AC\\uC6A9\"));return{totalAmount:100,unitType:'g'};// ê¸°ë³¸ê°’\n};const packageAnalysis=analyzePackage(product.weight);const packageTotalAmount=packageAnalysis.totalAmount;const packageUnitType=packageAnalysis.unitType;const recipeUsage=ingredient.quantity;const recipeUnit=ingredient.unit;console.log(\"\\uD83E\\uDDEE \\uACC4\\uC0B0 \\uC911: \".concat(product.name));console.log(\"\\uD83D\\uDCE6 \\uD328\\uD0A4\\uC9C0: \".concat(packageTotalAmount).concat(packageUnitType));console.log(\"\\uD83E\\uDD44 \\uB808\\uC2DC\\uD53C \\uC0AC\\uC6A9\\uB7C9: \".concat(recipeUsage).concat(recipeUnit));// ğŸ”¢ ë‹¨ìœ„ í†µì¼ í›„ ê³„ì‚°\nlet maxRecipesFromThisIngredient;if(recipeUnit==='g'&&(packageUnitType==='g'||packageUnitType==='ml')){// ê·¸ë¨ ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\nmaxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeUsage);}else if(recipeUnit==='ml'&&packageUnitType==='ml'){// ë°€ë¦¬ë¦¬í„° ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\nmaxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeUsage);}else if(recipeUnit==='ê°œ'&&packageUnitType==='ê°œ'){// ê°œìˆ˜ ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\nmaxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeUsage);}else if(recipeUnit==='í°ìˆ '){// í°ìˆ  = ì•½ 15ml/15g\nconst recipeAmountInGrams=recipeUsage*15;maxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeAmountInGrams);}else if(recipeUnit==='ì‘ì€ìˆ '){// ì‘ì€ìˆ  = ì•½ 5ml/5g\nconst recipeAmountInGrams=recipeUsage*5;maxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeAmountInGrams);}else if(recipeUnit==='ì»µ'){// ì»µ = ì•½ 200ml/200g\nconst recipeAmountInGrams=recipeUsage*200;maxRecipesFromThisIngredient=Math.floor(packageTotalAmount/recipeAmountInGrams);}else{// ê¸°íƒ€ ë‹¨ìœ„: ë³´ìˆ˜ì  ê³„ì‚°\nconsole.warn(\"\\u26A0\\uFE0F \\uB2E8\\uC704 \\uBCC0\\uD658 \\uBD88\\uAC00: \".concat(recipeUnit,\" \\u2194 \").concat(packageUnitType));maxRecipesFromThisIngredient=Math.floor(packageTotalAmount/(recipeUsage*10));}// ğŸ›¡ï¸ 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€\nif(maxRecipesFromThisIngredient<=0){console.warn(\"\\u26A0\\uFE0F \\uACC4\\uC0B0 \\uACB0\\uACFC\\uAC00 0 \\uC774\\uD558: \".concat(product.name,\" - \\uCD5C\\uC18C\\uAC12 1\\uB85C \\uC124\\uC815\"));maxRecipesFromThisIngredient=1;}const costPerRecipe=Math.round(product.price/maxRecipesFromThisIngredient);console.log(\"\\u2705 \\uACB0\\uACFC: \".concat(maxRecipesFromThisIngredient,\"\\uBC88 \\uAC00\\uB2A5, 1\\uD68C\\uB2F9 \").concat(costPerRecipe,\"\\uC6D0\"));return{productName:product.name,productPackageSize:product.weight,usagePerRecipe:\"\".concat(recipeUsage).concat(recipeUnit),maxRecipesFromThisIngredient:maxRecipesFromThisIngredient,costPerRecipe:costPerRecipe,totalProductCost:product.price};});// ğŸ¯ ë³‘ëª© ì¬ë£Œ ì°¾ê¸° (ê°€ì¥ ì ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ” íšŸìˆ˜)\nconst minPossibleRecipes=Math.min(...ingredientAnalysis.map(analysis=>analysis.maxRecipesFromThisIngredient));// ğŸ“Š í‰ê·  ì œì¡° ê°€ëŠ¥ íšŸìˆ˜\nconst averageRecipesPerIngredient=Math.round(ingredientAnalysis.reduce((sum,analysis)=>sum+analysis.maxRecipesFromThisIngredient,0)/ingredientAnalysis.length);// ğŸ’° ë ˆì‹œí”¼ 1íšŒë‹¹ ì´ ë¹„ìš©\nconst totalCostPerRecipe=ingredientAnalysis.reduce((sum,analysis)=>sum+analysis.costPerRecipe,0);return{recipeId,recipeName:(recipe===null||recipe===void 0?void 0:recipe.name)||'ì•Œ ìˆ˜ ì—†ëŠ” ë ˆì‹œí”¼',ingredientAnalysis,minPossibleRecipes,averageRecipesPerIngredient,totalCostPerRecipe:Math.round(totalCostPerRecipe)};};// ğŸ’° ì˜ˆì‚° ê¸°ë°˜ ë ˆì‹œí”¼ í•„í„°ë§ ë° ì¡°í•© ì„ íƒ\nconst getBudgetAwareRecipeCombination=(goalRecipes,monthlyBudget,nutritionTargets)=>{// ê° ë ˆì‹œí”¼ì˜ ì›”ê°„ ë¹„ìš©ê³¼ ì˜ì–‘ê°€ ê³„ì‚°\nconst recipeAnalysis=goalRecipes.map(recipe=>{const monthlyCost=calculateRecipeMonthlyCost(recipe.id,10);// í•œ ë‹¬ì— 10ë²ˆ í•´ë‹¹ ë ˆì‹œí”¼\nconst nutrition=calculateRecipeNutrition(recipe.id);const nutritionScore=(nutrition.protein*4+nutrition.carb*4+nutrition.fat*9)/monthlyCost;// ì›ë‹¹ ì˜ì–‘ê°€\nreturn{recipe,monthlyCost,nutrition,nutritionScore,costPerCalorie:monthlyCost/(nutrition.calories||1)};});// ì˜ˆì‚° ë²”ìœ„ ë‚´ ë ˆì‹œí”¼ë“¤ë§Œ í•„í„°ë§\nconst affordableRecipes=recipeAnalysis.filter(analysis=>analysis.monthlyCost<=monthlyBudget*0.4// ë‹¨ì¼ ë ˆì‹œí”¼ê°€ ì˜ˆì‚°ì˜ 40%ë¥¼ ë„˜ì§€ ì•Šë„ë¡\n);if(affordableRecipes.length===0){// ì˜ˆì‚°ì´ ë„ˆë¬´ ì ìœ¼ë©´ ê°€ì¥ ì €ë ´í•œ ë ˆì‹œí”¼ë“¤ ì„ íƒ\nconst sortedByCost=recipeAnalysis.sort((a,b)=>a.monthlyCost-b.monthlyCost);return sortedByCost.slice(0,3).map(analysis=>analysis.recipe);}// ğŸ¯ ìµœì  ì¡°í•© ì°¾ê¸° (ì˜ˆì‚° ë‚´ì—ì„œ ì˜ì–‘ê°€ ìµœëŒ€í™”) - ì„±ëŠ¥ ìµœì í™”\nconst findOptimalCombination=()=>{const combinations=[];const maxCombinations=1000;// ì¡°í•© ìˆ˜ ì œí•œìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ\n// ê°€ê²© ê¸°ì¤€ ì‚¬ì „ ì •ë ¬ë¡œ ì¡°ê¸° ì¢…ë£Œ ìµœì í™”\nconst sortedByPrice=affordableRecipes.sort((a,b)=>a.monthlyCost-b.monthlyCost);// ì•„ì¹¨, ì ì‹¬, ì €ë…ìš© ë ˆì‹œí”¼ë¥¼ ê°ê° ì„ íƒ (ìµœì í™”ëœ ë£¨í”„)\nouterLoop:for(let i=0;i<sortedByPrice.length&&combinations.length<maxCombinations;i++){const breakfast=sortedByPrice[i];for(let j=0;j<sortedByPrice.length&&combinations.length<maxCombinations;j++){const lunch=sortedByPrice[j];// ì¡°ê¸° ì¢…ë£Œ ì¡°ê±´ (2ê°œ í•©ê³„ê°€ ì´ë¯¸ ì˜ˆì‚° ì´ˆê³¼)\nif(breakfast.monthlyCost+lunch.monthlyCost>monthlyBudget*0.9){continue;}for(let k=0;k<sortedByPrice.length&&combinations.length<maxCombinations;k++){const dinner=sortedByPrice[k];const totalCost=breakfast.monthlyCost+lunch.monthlyCost+dinner.monthlyCost;if(totalCost<=monthlyBudget){combinations.push([breakfast.recipe,lunch.recipe,dinner.recipe]);}else{// ê°€ê²©ìˆœ ì •ë ¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë” ì´ìƒ í™•ì¸ ë¶ˆí•„ìš”\nbreak;}}}}if(combinations.length===0){// 3ê°œ ì¡°í•©ì´ ë¶ˆê°€ëŠ¥í•˜ë©´ ê°€ì¥ ì €ë ´í•œ 2ê°œ ì„ íƒ\nconst sortedByCost=affordableRecipes.sort((a,b)=>a.monthlyCost-b.monthlyCost);return sortedByCost.slice(0,2).map(analysis=>analysis.recipe);}// ì˜ì–‘ê°€ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ ì¡°í•© ì„ íƒ\nlet bestCombination=combinations[0];let bestScore=0;combinations.forEach(combination=>{const totalNutrition=combination.reduce((sum,recipe)=>{const nutrition=calculateRecipeNutrition(recipe.id);return{calories:sum.calories+nutrition.calories,protein:sum.protein+nutrition.protein,carb:sum.carb+nutrition.carb,fat:sum.fat+nutrition.fat};},{calories:0,protein:0,carb:0,fat:0});// ëª©í‘œ ì˜ì–‘ì†Œì™€ì˜ ê·¼ì‚¬ë„ ì ìˆ˜\nconst calorieScore=100-Math.abs(totalNutrition.calories-nutritionTargets.targetCalories)/nutritionTargets.targetCalories*100;const proteinScore=100-Math.abs(totalNutrition.protein-nutritionTargets.macroGrams.protein)/nutritionTargets.macroGrams.protein*100;const combinationScore=Math.max(0,calorieScore)+Math.max(0,proteinScore);if(combinationScore>bestScore){bestScore=combinationScore;bestCombination=combination;}});return bestCombination;};return findOptimalCombination();};// ğŸ¯ ì „ì²´ ê°œì¸í™” ì¶”ì²œ í†µí•© í•¨ìˆ˜\nexport const generatePersonalizedRecommendations=(userProfile,calorieCalculation,preferences,history)=>{const context={userProfile,calorieCalculation,currentTime:new Date(),preferences,history};const nutritionTargets=calculatePersonalizedNutritionTargets(userProfile,calorieCalculation);const recommendedProducts=getPersonalizedProductRecommendations(context);const recommendedRecipes=getPersonalizedRecipeRecommendations(context);// ê°œì¸í™” ë©”ì‹œì§€ ìƒì„±\nconst personalizedMessage=generatePersonalizedMessage(userProfile,nutritionTargets);return{nutritionTargets,recommendedProducts,recommendedRecipes,personalizedMessage,context};};// ğŸ’° ì˜ˆì‚° ê³ ë ¤ ê°œì¸í™” ì¶”ì²œ í•¨ìˆ˜ (ë©”ì¸)\nexport const generateBudgetAwareRecommendations=async(userProfile,calorieCalculation,monthlyBudget,preferences,history)=>{const context={userProfile,calorieCalculation,currentTime:new Date(),preferences,history};const nutritionTargets=calculatePersonalizedNutritionTargets(userProfile,calorieCalculation);// ğŸ¯ ëª©í‘œì— ë§ëŠ” ëª¨ë“  ë ˆì‹œí”¼ ê°€ì ¸ì˜¤ê¸° (ë¹„ë™ê¸°)\nconst goalRecipes=await getRecipesByGoal(userProfile.goal||'maintenance');// ğŸ’° ì˜ˆì‚° ê¸°ë°˜ ìµœì  ë ˆì‹œí”¼ ì¡°í•© ì„ íƒ\nconst budgetOptimizedRecipes=getBudgetAwareRecipeCombination(goalRecipes,monthlyBudget,nutritionTargets);// ğŸ“Š ì˜ˆì‚° ë¶„ì„\nconst costBreakdown=budgetOptimizedRecipes.map(recipe=>{const monthlyCost=calculateRecipeMonthlyCost(recipe.id,10);return{recipeId:recipe.id,recipeName:recipe.name,monthlyCost,costPercentage:monthlyCost/monthlyBudget*100};});const totalEstimatedCost=costBreakdown.reduce((sum,item)=>sum+item.monthlyCost,0);const budgetUsagePercentage=totalEstimatedCost/monthlyBudget*100;// ì œí’ˆ ì¶”ì²œì€ ê¸°ì¡´ ë¡œì§ í™œìš©\nconst recommendedProducts=getPersonalizedProductRecommendations(context);// ğŸ’¬ ì˜ˆì‚° ê³ ë ¤ ë©”ì‹œì§€ ìƒì„±\nconst personalizedMessage=generateBudgetAwareMessage(userProfile,nutritionTargets,monthlyBudget,totalEstimatedCost);return{personalizedMessage,nutritionTargets,recommendedProducts,recommendedRecipes:budgetOptimizedRecipes,budgetAnalysis:{totalEstimatedCost,budgetUsagePercentage,costBreakdown},context};};// ğŸ’¬ ê°œì¸í™” ë©”ì‹œì§€ ìƒì„±\nconst generatePersonalizedMessage=(userProfile,targets)=>{const{goal,gender,age,weight}=userProfile;const{targetCalories,dailyProteinNeeds}=targets;const goalMessages={weight_loss:\"\".concat(gender==='male'?'í˜•':'ë‹˜',\"\\uC758 \\uB2E4\\uC774\\uC5B4\\uD2B8 \\uC131\\uACF5\\uC744 \\uC704\\uD574 \\uC77C\\uC77C \").concat(targetCalories,\"kcal, \\uB2E8\\uBC31\\uC9C8 \").concat(Math.round(dailyProteinNeeds),\"g \\uBAA9\\uD45C\\uB85C \\uB9DE\\uCDA4 \\uC2DD\\uB2E8\\uC744 \\uC900\\uBE44\\uD588\\uC5B4\\uC694! \\uD83D\\uDCAA\"),muscle_gain:\"\".concat(age,\"\\uC138 \").concat(gender==='male'?'í˜•':'ë‹˜',\"\\uC758 \\uADFC\\uC131\\uC7A5\\uC744 \\uC704\\uD574 \\uC77C\\uC77C \").concat(targetCalories,\"kcal, \\uACE0\\uB2E8\\uBC31 \").concat(Math.round(dailyProteinNeeds),\"g \\uC2DD\\uB2E8\\uC73C\\uB85C \\uAD6C\\uC131\\uD588\\uC5B4\\uC694! \\uD83D\\uDD25\"),maintenance:\"\".concat(weight,\"kg \\uAC74\\uAC15 \\uC720\\uC9C0\\uB97C \\uC704\\uD574 \\uC77C\\uC77C \").concat(targetCalories,\"kcal \\uADE0\\uD615 \\uC7A1\\uD78C \\uC2DD\\uB2E8\\uC744 \\uCD94\\uCC9C\\uB4DC\\uB824\\uC694! \\u2696\\uFE0F\")};return goalMessages[goal]||'ë§ì¶¤í˜• ì‹ë‹¨ì„ ì¤€ë¹„í–ˆì–´ìš”! ğŸ¯';};// ğŸ’° ì˜ˆì‚° ê³ ë ¤ ë©”ì‹œì§€ ìƒì„±\nconst generateBudgetAwareMessage=(userProfile,targets,monthlyBudget,estimatedCost)=>{const{goal,gender}=userProfile;const{targetCalories,dailyProteinNeeds}=targets;const savings=monthlyBudget-estimatedCost;const usagePercentage=estimatedCost/monthlyBudget*100;const baseMessage=\"\".concat(gender==='male'?'í˜•':'ë‹˜',\"\\uC758 \").concat(goal==='weight_loss'?'ë‹¤ì´ì–´íŠ¸':goal==='muscle_gain'?'ê·¼ì„±ì¥':'ê±´ê°•ìœ ì§€',\" \\uBAA9\\uD45C\\uC5D0 \\uB9DE\\uCDB0\");if(usagePercentage<=70){return\"\".concat(baseMessage,\" \\uC608\\uC0B0\\uC744 \\uC54C\\uB730\\uD558\\uAC8C \\uD65C\\uC6A9\\uD55C \\uC2DD\\uB2E8\\uC744 \\uC900\\uBE44\\uD588\\uC5B4\\uC694! \\uD83D\\uDCB0 \\uC6D4 \").concat(estimatedCost.toLocaleString(),\"\\uC6D0\\uC73C\\uB85C \\uBAA9\\uD45C \\uB2EC\\uC131\\uC774 \\uAC00\\uB2A5\\uD574\\uC694 (\").concat(savings.toLocaleString(),\"\\uC6D0 \\uC808\\uC57D!) \\uD83C\\uDFAF\");}else if(usagePercentage<=90){return\"\".concat(baseMessage,\" \\uC608\\uC0B0\\uC5D0 \\uB531 \\uB9DE\\uB294 \\uD6A8\\uC728\\uC801\\uC778 \\uC2DD\\uB2E8\\uC744 \\uAD6C\\uC131\\uD588\\uC5B4\\uC694! \\uD83D\\uDCAA \\uC6D4 \").concat(estimatedCost.toLocaleString(),\"\\uC6D0\\uC73C\\uB85C \\uBAA9\\uD45C \\uC601\\uC591\\uC18C\\uB97C \\uCDA9\\uC871\\uD560 \\uC218 \\uC788\\uC5B4\\uC694! \\uD83C\\uDFAF\");}else{return\"\".concat(baseMessage,\" \\uC608\\uC0B0\\uC744 \\uCD5C\\uB300\\uD55C \\uD65C\\uC6A9\\uD55C \\uAC00\\uC131\\uBE44 \\uCD5C\\uACE0\\uC758 \\uC2DD\\uB2E8\\uC774\\uC5D0\\uC694! \\uD83D\\uDCAF \\uC6D4 \").concat(estimatedCost.toLocaleString(),\"\\uC6D0\\uC73C\\uB85C \\uCD5C\\uACE0\\uC758 \\uC601\\uC591 \\uD6A8\\uACFC\\uB97C \\uC5BB\\uC73C\\uC138\\uC694! \\uD83D\\uDD25\");}};","map":{"version":3,"names":["weightLossProducts","muscleGainProducts","maintenanceProducts","getRecipesByGoal","calculateRecipeNutrition","getRecipeIngredients","calculatePersonalizedNutritionTargets","userProfile","calorieCalculation","goal","weight","height","age","gender","targetCalories","proteinPerKg","weight_loss","maintenance","muscle_gain","dailyProteinNeeds","proteinCalories","proteinPercentage","fatPercentage","carbPercentage","macroPercentages","protein","Math","max","min","fat","carb","macroGrams","getPersonalizedProductRecommendations","context","nutritionTargets","candidateProducts","filter","p","nutrition","calories","slice","dailyBudget","budget","mealBudget","affordableProducts","product","productDuration","getProductDuration","costPerMeal","price","scoredProducts","map","score","calculateAdvancedNutrientScore","sortedProducts","sort","a","b","diverseProducts","ensureProductDiversity","sp","getPersonalizedRecipeRecommendations","baseRecipes","currentHour","currentTime","getHours","mealType","filteredRecipes","recipe","_context$preferences","_context$preferences2","_context$preferences3","preferences","cookingTime","difficulty","scoredRecipes","calculateRecipePersonalizationScore","sr","targets","calorieRatio","fatRatio","sodium","nutritionValue","pricePerNutrition","_context$preferences4","_context$preferences5","_context$preferences6","_context$preferences7","_context$history","goalFit","includes","recipeNutrition","id","proteinRatio","targetProteinRatio","abs","history","cookedRecipes","products","categorySet","Set","category","categories","Array","from","forEach","categoryProducts","length","push","remainingProducts","calculateRecipeMonthlyCost","recipeId","monthlyFrequency","arguments","undefined","ingredients","totalMonthlyCost","ingredient","recipesPerProduct","costPerRecipe","monthlyCost","round","calculateRecipeFrequency","name","concat","ingredientAnalysis","analyzePackage","packageInfo","console","log","gramPackPattern","gramPackMatch","match","perPack","parseInt","packCount","totalAmount","unitType","gramItemPattern","gramItemMatch","perItem","itemCount","singleKgPattern","singleKgMatch","kg","singleGramPattern","singleGramMatch","grams","singleCountPattern","singleCountMatch","count","literPattern","literMatch","liters","parseFloat","mlPattern","mlMatch","ml","warn","packageAnalysis","packageTotalAmount","packageUnitType","recipeUsage","quantity","recipeUnit","unit","maxRecipesFromThisIngredient","floor","recipeAmountInGrams","productName","productPackageSize","usagePerRecipe","totalProductCost","minPossibleRecipes","analysis","averageRecipesPerIngredient","reduce","sum","totalCostPerRecipe","recipeName","getBudgetAwareRecipeCombination","goalRecipes","monthlyBudget","recipeAnalysis","nutritionScore","costPerCalorie","affordableRecipes","sortedByCost","findOptimalCombination","combinations","maxCombinations","sortedByPrice","outerLoop","i","breakfast","j","lunch","k","dinner","totalCost","bestCombination","bestScore","combination","totalNutrition","calorieScore","proteinScore","combinationScore","generatePersonalizedRecommendations","Date","recommendedProducts","recommendedRecipes","personalizedMessage","generatePersonalizedMessage","generateBudgetAwareRecommendations","budgetOptimizedRecipes","costBreakdown","costPercentage","totalEstimatedCost","item","budgetUsagePercentage","generateBudgetAwareMessage","budgetAnalysis","goalMessages","estimatedCost","savings","usagePercentage","baseMessage","toLocaleString"],"sources":["/Users/kim_seung_bin/Desktop/ksb/public/dev/kkssbbb-github-repo/SmartMealPlanner_front/src/utils/personalizedRecommendation.ts"],"sourcesContent":["import { UserProfile, CalorieCalculation, CoupangProduct, Recipe, PersonalizedNutritionTargets } from '../types';\nimport { \n  weightLossProducts, \n  muscleGainProducts, \n  maintenanceProducts\n} from '../data/mockProducts';\nimport { getRecipesByGoal, calculateRecipeNutrition, getRecipeIngredients } from '../data/recipeData';\n\n// ğŸ¯ ê°œì¸í™” ì¶”ì²œ ì»¨í…ìŠ¤íŠ¸\nexport interface PersonalizedContext {\n  userProfile: UserProfile;\n  calorieCalculation: CalorieCalculation;\n  currentTime: Date;\n  preferences?: {\n    cuisineTypes?: string[];         // ì„ í˜¸ ìš”ë¦¬ ì¢…ë¥˜\n    allergens?: string[];            // ì•Œë ˆë¥´ê¸° ìœ ë°œ ìš”ì†Œ\n    cookingTime?: 'quick' | 'normal' | 'slow'; // ì¡°ë¦¬ ì‹œê°„ ì„ í˜¸ë„\n    difficulty?: 'easy' | 'medium' | 'hard';   // ë‚œì´ë„ ì„ í˜¸ë„\n    priceRange?: 'budget' | 'standard' | 'premium'; // ê°€ê²©ëŒ€ ì„ í˜¸ë„\n  };\n  history?: {\n    purchasedProducts?: string[];    // êµ¬ë§¤ ì´ë ¥\n    cookedRecipes?: string[];        // ì¡°ë¦¬ ì´ë ¥\n    favoriteIngredients?: string[];  // ì„ í˜¸ ì¬ë£Œ\n  };\n}\n\n// ğŸ§® ì‚¬ìš©ìë³„ ë§ì¶¤ ì˜ì–‘ì†Œ ëª©í‘œ ê³„ì‚°\nexport const calculatePersonalizedNutritionTargets = (\n  userProfile: UserProfile,\n  calorieCalculation: CalorieCalculation\n) => {\n  const { goal, weight, height, age, gender } = userProfile;\n  const { targetCalories } = calorieCalculation;\n\n  // ëª©í‘œë³„ ë‹¨ë°±ì§ˆ í•„ìš”ëŸ‰ (ì²´ì¤‘ 1kgë‹¹)\n  const proteinPerKg = {\n    weight_loss: 1.6,    // ë‹¤ì´ì–´íŠ¸: ê·¼ì†ì‹¤ ë°©ì§€ë¥¼ ìœ„í•´ ë†’ì€ ë‹¨ë°±ì§ˆ\n    maintenance: 1.2,    // ìœ ì§€: ì¼ë°˜ ê¶Œì¥ëŸ‰\n    muscle_gain: 1.8     // ê·¼ì„±ì¥: ë†’ì€ ë‹¨ë°±ì§ˆ í•„ìš”\n  };\n\n  // ê°œì¸ë³„ ë‹¨ë°±ì§ˆ í•„ìš”ëŸ‰ ê³„ì‚°\n  const dailyProteinNeeds = weight * proteinPerKg[goal];\n  const proteinCalories = dailyProteinNeeds * 4;\n  const proteinPercentage = (proteinCalories / targetCalories) * 100;\n\n  // ëª©í‘œë³„ ì§€ë°© ë¹„ìœ¨ ì¡°ì •\n  const fatPercentage = {\n    weight_loss: 20,     // ë‹¤ì´ì–´íŠ¸: ë‚®ì€ ì§€ë°©\n    maintenance: 30,     // ìœ ì§€: ê· í˜•\n    muscle_gain: 25      // ê·¼ì„±ì¥: ì¤‘ê°„ ì§€ë°©\n  }[goal];\n\n  // ë‚˜ë¨¸ì§€ëŠ” íƒ„ìˆ˜í™”ë¬¼\n  const carbPercentage = 100 - proteinPercentage - fatPercentage;\n\n  return {\n    targetCalories,\n    dailyProteinNeeds,\n    macroPercentages: {\n      protein: Math.max(15, Math.min(35, proteinPercentage)), // 15-35% ë²”ìœ„\n      fat: fatPercentage,\n      carb: Math.max(30, carbPercentage) // ìµœì†Œ 30%\n    },\n    macroGrams: {\n      protein: dailyProteinNeeds,\n      fat: (targetCalories * fatPercentage / 100) / 9,\n      carb: (targetCalories * carbPercentage / 100) / 4\n    }\n  };\n};\n\n// ğŸ¯ ìŠ¤ë§ˆíŠ¸ ì œí’ˆ ì¶”ì²œ ì—”ì§„\nexport const getPersonalizedProductRecommendations = (\n  context: PersonalizedContext\n): CoupangProduct[] => {\n  const { userProfile, calorieCalculation } = context;\n  const nutritionTargets = calculatePersonalizedNutritionTargets(userProfile, calorieCalculation);\n  \n  // ëª©í‘œë³„ ê¸°ë³¸ ì œí’ˆêµ° ì„ íƒ\n  let candidateProducts: CoupangProduct[] = [];\n  \n  switch (userProfile.goal) {\n    case 'weight_loss':\n      candidateProducts = [\n        ...weightLossProducts,\n        ...maintenanceProducts.filter(p => p.nutrition.calories < 150)\n      ];\n      break;\n    case 'muscle_gain':\n      candidateProducts = [\n        ...muscleGainProducts,\n        ...maintenanceProducts.filter(p => p.nutrition.protein > 15)\n      ];\n      break;\n    case 'maintenance':\n    default:\n      candidateProducts = [...maintenanceProducts, ...weightLossProducts.slice(0, 2)];\n      break;\n  }\n\n  // ì˜ˆì‚° í•„í„°ë§ (ë” í˜„ì‹¤ì ì¸ ì ‘ê·¼)\n  const dailyBudget = userProfile.budget / 30; // ì¼ì¼ ì˜ˆì‚°\n  const mealBudget = dailyBudget / 3; // ë¼ë‹ˆë‹¹ ì˜ˆì‚°\n  \n  const affordableProducts = candidateProducts.filter(product => {\n    // 1ì£¼ì¼ì¹˜ êµ¬ë§¤ ì‹œ ë¼ë‹ˆë‹¹ ë¹„ìš© ê³„ì‚°\n    const productDuration = getProductDuration(product);\n    const costPerMeal = (product.price / productDuration) / 3;\n    return costPerMeal <= mealBudget * 2; // ì˜ˆì‚°ì˜ 200%ê¹Œì§€ í—ˆìš©\n  });\n\n  // ì˜ì–‘ì†Œ ì í•©ì„± ì ìˆ˜ ê³„ì‚°\n  const scoredProducts = affordableProducts.map(product => ({\n    product,\n    score: calculateAdvancedNutrientScore(product, nutritionTargets, context)\n  }));\n\n  // ì ìˆ˜ìˆœ ì •ë ¬ ë° ë‹¤ì–‘ì„± ë³´ì¥\n  const sortedProducts = scoredProducts\n    .sort((a, b) => b.score - a.score)\n    .slice(0, 20); // ìƒìœ„ 20ê°œ ì„ ë³„\n\n  // ì¹´í…Œê³ ë¦¬ë³„ ë‹¤ì–‘ì„± ë³´ì¥\n  const diverseProducts = ensureProductDiversity(sortedProducts.map(sp => sp.product));\n  \n  return diverseProducts.slice(0, 12);\n};\n\n// ğŸ³ ìŠ¤ë§ˆíŠ¸ ë ˆì‹œí”¼ ì¶”ì²œ ì—”ì§„\nexport const getPersonalizedRecipeRecommendations = async (\n  context: PersonalizedContext\n): Promise<Recipe[]> => {\n  const { userProfile } = context;\n  const baseRecipes = await getRecipesByGoal(userProfile.goal);\n  \n  // ì‹œê°„ëŒ€ë³„ í•„í„°ë§\n  const currentHour = context.currentTime.getHours();\n  let mealType: 'breakfast' | 'lunch' | 'dinner';\n  \n  if (currentHour < 11) mealType = 'breakfast';\n  else if (currentHour < 17) mealType = 'lunch'; \n  else mealType = 'dinner';\n\n  // ì‚¬ìš©ì ì„ í˜¸ë„ ë°˜ì˜\n  let filteredRecipes = baseRecipes.filter((recipe: Recipe) => {\n    // ì‹œê°„ëŒ€ ë§ì¶¤\n    if (recipe.mealType !== mealType) return false;\n    \n    // ì¡°ë¦¬ì‹œê°„ ì„ í˜¸ë„\n    if (context.preferences?.cookingTime === 'quick' && recipe.cookingTime > 15) return false;\n    if (context.preferences?.cookingTime === 'slow' && recipe.cookingTime < 20) return false;\n    \n    // ë‚œì´ë„ ì„ í˜¸ë„\n    if (context.preferences?.difficulty && recipe.difficulty !== context.preferences.difficulty) {\n      return false;\n    }\n    \n    return true;\n  });\n\n  // ì˜ì–‘ ëª©í‘œì— ë§ëŠ” ë ˆì‹œí”¼ ì ìˆ˜ ê³„ì‚°\n  const nutritionTargets = calculatePersonalizedNutritionTargets(userProfile, context.calorieCalculation);\n  \n  const scoredRecipes = filteredRecipes.map((recipe: Recipe) => ({\n    recipe,\n    score: calculateRecipePersonalizationScore(recipe, nutritionTargets, context)\n  }));\n\n  // ì ìˆ˜ìˆœ ì •ë ¬\n  return scoredRecipes\n    .sort((a: any, b: any) => b.score - a.score)\n    .map((sr: any) => sr.recipe)\n    .slice(0, 6);\n};\n\n// ğŸ¯ ê³ ê¸‰ ì˜ì–‘ì†Œ ì ìˆ˜ ê³„ì‚°\nconst calculateAdvancedNutrientScore = (\n  product: CoupangProduct,\n  targets: ReturnType<typeof calculatePersonalizedNutritionTargets>,\n  context: PersonalizedContext\n): number => {\n  let score = 0;\n  const nutrition = product.nutrition;\n  \n  // ëª©í‘œ ì¹¼ë¡œë¦¬ ëŒ€ë¹„ ì í•©ì„± (30%)\n  const calorieRatio = nutrition.calories / targets.targetCalories * 100;\n  if (calorieRatio > 5 && calorieRatio < 25) score += 30;\n  else if (calorieRatio <= 5) score += 20;\n  \n  // ë‹¨ë°±ì§ˆ í•¨ëŸ‰ í‰ê°€ (25%)\n  if (context.userProfile.goal === 'weight_loss' || context.userProfile.goal === 'muscle_gain') {\n    if (nutrition.protein > 20) score += 25;\n    else if (nutrition.protein > 15) score += 20;\n    else if (nutrition.protein > 10) score += 10;\n  } else {\n    if (nutrition.protein > 5) score += 25;\n  }\n  \n  // ì§€ë°© í•¨ëŸ‰ í‰ê°€ (20%)\n  const fatRatio = (nutrition.fat * 9) / nutrition.calories * 100;\n  if (context.userProfile.goal === 'weight_loss' && fatRatio < 30) score += 20;\n  else if (context.userProfile.goal === 'muscle_gain' && fatRatio > 20 && fatRatio < 40) score += 20;\n  else if (context.userProfile.goal === 'maintenance' && fatRatio > 25 && fatRatio < 35) score += 20;\n  \n  // ë‚˜íŠ¸ë¥¨ í•¨ëŸ‰ í‰ê°€ (15%)\n  if (nutrition.sodium < 300) score += 15;\n  else if (nutrition.sodium < 500) score += 10;\n  else if (nutrition.sodium < 800) score += 5;\n  \n  // ê°€ê²© ëŒ€ë¹„ ì˜ì–‘ê°€ (10%)\n  const nutritionValue = (nutrition.protein * 4 + nutrition.carb * 4 + nutrition.fat * 9);\n  const pricePerNutrition = product.price / nutritionValue;\n  if (pricePerNutrition < 50) score += 10;\n  else if (pricePerNutrition < 100) score += 5;\n  \n  return Math.min(100, score);\n};\n\n// ğŸ³ ë ˆì‹œí”¼ ê°œì¸í™” ì ìˆ˜ ê³„ì‚°\nconst calculateRecipePersonalizationScore = (\n  recipe: Recipe,\n  targets: ReturnType<typeof calculatePersonalizedNutritionTargets>,\n  context: PersonalizedContext\n): number => {\n  let score = 0;\n  \n  // ëª©í‘œ ì í•©ì„± (40%)\n  if (recipe.goalFit.includes(context.userProfile.goal)) score += 40;\n  \n  // ì¡°ë¦¬ì‹œê°„ ì í•©ì„± (20%)\n  if (context.preferences?.cookingTime === 'quick' && recipe.cookingTime <= 15) score += 20;\n  else if (context.preferences?.cookingTime === 'normal' && recipe.cookingTime <= 30) score += 20;\n  else if (context.preferences?.cookingTime === 'slow' && recipe.cookingTime > 30) score += 20;\n  else score += 10;\n  \n  // ë‚œì´ë„ ì í•©ì„± (15%)\n  if (context.preferences?.difficulty === recipe.difficulty) score += 15;\n  else score += 5;\n  \n  // ì˜ì–‘ì†Œ ê· í˜• (15%)\n  const recipeNutrition = calculateRecipeNutrition(recipe.id);\n  if (recipeNutrition.calories > 0) {\n    const proteinRatio = (recipeNutrition.protein * 4) / recipeNutrition.calories * 100;\n    const targetProteinRatio = targets.macroPercentages.protein;\n    \n    if (Math.abs(proteinRatio - targetProteinRatio) < 10) score += 15;\n    else if (Math.abs(proteinRatio - targetProteinRatio) < 20) score += 10;\n  }\n  \n  // ìµœê·¼ ì¡°ë¦¬ ì´ë ¥ (10%) - ë‹¤ì–‘ì„± ë³´ì¥\n  if (context.history?.cookedRecipes && !context.history.cookedRecipes.includes(recipe.id)) {\n    score += 10;\n  } else {\n    score += 5;\n  }\n  \n  return Math.min(100, score);\n};\n\n// ğŸ›¡ï¸ ì œí’ˆ ë‹¤ì–‘ì„± ë³´ì¥\nconst ensureProductDiversity = (products: CoupangProduct[]): CoupangProduct[] => {\n  const categorySet = new Set(products.map(p => p.category));\n  const categories = Array.from(categorySet);\n  const diverseProducts: CoupangProduct[] = [];\n  \n  // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ìµœì†Œ 1ê°œì”© ì„ íƒ\n  categories.forEach(category => {\n    const categoryProducts = products.filter(p => p.category === category);\n    if (categoryProducts.length > 0) {\n      diverseProducts.push(categoryProducts[0]);\n    }\n  });\n  \n  // ë‚˜ë¨¸ì§€ ìë¦¬ëŠ” ì ìˆ˜ ìˆœìœ¼ë¡œ ì±„ìš°ê¸°\n  const remainingProducts = products.filter(p => !diverseProducts.includes(p));\n  diverseProducts.push(...remainingProducts.slice(0, 12 - diverseProducts.length));\n  \n  return diverseProducts;\n};\n\n// ğŸ“¦ ì œí’ˆ ì§€ì† ê¸°ê°„ ì¶”ì • (ì¼ ë‹¨ìœ„)\nconst getProductDuration = (product: CoupangProduct): number => {\n  // ì œí’ˆëª…ê³¼ ìš©ëŸ‰ ì •ë³´ë¡œ ì§€ì† ê¸°ê°„ ì¶”ì •\n  if (product.weight.includes('30íŒ©')) return 30;\n  if (product.weight.includes('20ê°œ') || product.weight.includes('20íŒ©')) return 20;\n  if (product.weight.includes('15íŒ©')) return 15;\n  if (product.weight.includes('12ê°œ') || product.weight.includes('12íŒ©')) return 12;\n  if (product.weight.includes('10íŒ©') || product.weight.includes('10ê°œ')) return 10;\n  if (product.weight.includes('8íŒ©') || product.weight.includes('8ê°œ')) return 8;\n  if (product.weight.includes('6ê°œ') || product.weight.includes('6íŒ©')) return 6;\n  if (product.weight.includes('5kg')) return 20; // 5kg ì œí’ˆì€ ì•½ 20ì¼\n  if (product.weight.includes('3kg')) return 15; // 3kg ì œí’ˆì€ ì•½ 15ì¼\n  if (product.weight.includes('500g')) return 5;  // 500g ì œí’ˆì€ ì•½ 5ì¼\n  return 7; // ê¸°ë³¸ê°’: 1ì£¼ì¼\n};\n\n// ğŸ’° ë ˆì‹œí”¼ë³„ ì›”ê°„ ë¹„ìš© ê³„ì‚° (ì •í™•í•œ ê³„ì‚°)\nconst calculateRecipeMonthlyCost = (recipeId: string, monthlyFrequency: number = 10): number => {\n  const ingredients = getRecipeIngredients(recipeId);\n  let totalMonthlyCost = 0;\n\n  ingredients.forEach(ingredient => {\n    const product = ingredient.product;\n    const productDuration = getProductDuration(product); // ì œí’ˆ ì§€ì† ê¸°ê°„ (ì¼)\n    const recipesPerProduct = productDuration; // í•œ ì œí’ˆìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë ˆì‹œí”¼ ìˆ˜\n    const costPerRecipe = product.price / recipesPerProduct; // ë ˆì‹œí”¼ 1íšŒë‹¹ ë¹„ìš©\n    const monthlyCost = costPerRecipe * monthlyFrequency; // ì›”ê°„ í•´ë‹¹ ì¬ë£Œ ë¹„ìš©\n    \n    totalMonthlyCost += monthlyCost;\n  });\n\n  return Math.round(totalMonthlyCost);\n};\n\n// ğŸ½ï¸ êµ¬ë§¤í•œ ì¬ë£Œë¡œ ë ˆì‹œí”¼ë¥¼ ëª‡ ë²ˆ í•´ë¨¹ì„ ìˆ˜ ìˆëŠ”ì§€ ê³„ì‚°\nexport const calculateRecipeFrequency = (recipeId: string): {\n  recipeId: string;\n  recipeName: string;\n  ingredientAnalysis: Array<{\n    productName: string;\n    productPackageSize: string;\n    usagePerRecipe: string;\n    maxRecipesFromThisIngredient: number;\n    costPerRecipe: number;\n    totalProductCost: number;\n  }>;\n  minPossibleRecipes: number; // ê°€ì¥ ì ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ” íšŸìˆ˜ (ë³‘ëª© ì¬ë£Œ ê¸°ì¤€)\n  averageRecipesPerIngredient: number;\n  totalCostPerRecipe: number;\n} => {\n  const ingredients = getRecipeIngredients(recipeId);\n  // recipes ë°°ì—´ì´ ì—†ìœ¼ë¯€ë¡œ ì„ì‹œ ë ˆì‹œí”¼ ì •ë³´ ì‚¬ìš©\n  const recipe = { id: recipeId, name: `ë ˆì‹œí”¼ ${recipeId}` };\n  \n  const ingredientAnalysis = ingredients.map((ingredient: any) => {\n    const product = ingredient.product;\n    \n    // ğŸ“¦ ì •í™•í•œ ì œí’ˆ íŒ¨í‚¤ì§€ ë¶„ì„ (ì‹¤ì œ mock ë°ì´í„° ê¸°ì¤€)\n    const analyzePackage = (packageInfo: string): { totalAmount: number, unitType: string } => {\n      console.log(`ğŸ” íŒ¨í‚¤ì§€ ë¶„ì„ ì¤‘: \"${packageInfo}\"`); // ë””ë²„ê·¸ìš©\n      \n      // íŒ¨í„´: \"ë‹¨ìœ„ x ê°œìˆ˜\" í˜•íƒœ ë¶„ì„\n      \n      // 1ï¸âƒ£ \"100g x 30íŒ©\" í˜•íƒœ\n      const gramPackPattern = /(\\d+)g\\s*x\\s*(\\d+)/i;\n      const gramPackMatch = packageInfo.match(gramPackPattern);\n      if (gramPackMatch) {\n        const perPack = parseInt(gramPackMatch[1]);\n        const packCount = parseInt(gramPackMatch[2]);\n        console.log(`ğŸ“¦ ê·¸ë¨íŒ©: ${perPack}g x ${packCount}íŒ© = ${perPack * packCount}g`);\n        return { totalAmount: perPack * packCount, unitType: 'g' };\n      }\n      \n      // 2ï¸âƒ£ \"150g x 12ê°œ\" í˜•íƒœ  \n      const gramItemPattern = /(\\d+)g\\s*x\\s*(\\d+)ê°œ/i;\n      const gramItemMatch = packageInfo.match(gramItemPattern);\n      if (gramItemMatch) {\n        const perItem = parseInt(gramItemMatch[1]);\n        const itemCount = parseInt(gramItemMatch[2]);\n        console.log(`ğŸ“¦ ê·¸ë¨ê°œìˆ˜: ${perItem}g x ${itemCount}ê°œ = ${perItem * itemCount}g`);\n        return { totalAmount: perItem * itemCount, unitType: 'g' };\n      }\n      \n      // 3ï¸âƒ£ \"5kg\" ë‹¨ì¼ í˜•íƒœ\n      const singleKgPattern = /(\\d+)kg/i;\n      const singleKgMatch = packageInfo.match(singleKgPattern);\n      if (singleKgMatch) {\n        const kg = parseInt(singleKgMatch[1]);\n        console.log(`ğŸ“¦ í‚¬ë¡œê·¸ë¨: ${kg}kg = ${kg * 1000}g`);\n        return { totalAmount: kg * 1000, unitType: 'g' };\n      }\n      \n      // 4ï¸âƒ£ \"500g\" ë‹¨ì¼ í˜•íƒœ\n      const singleGramPattern = /(\\d+)g(?!\\s*x)/i;\n      const singleGramMatch = packageInfo.match(singleGramPattern);\n      if (singleGramMatch) {\n        const grams = parseInt(singleGramMatch[1]);\n        console.log(`ğŸ“¦ ê·¸ë¨: ${grams}g`);\n        return { totalAmount: grams, unitType: 'g' };\n      }\n      \n      // 5ï¸âƒ£ \"12ê°œ\" ë‹¨ì¼ ê°œìˆ˜ í˜•íƒœ\n      const singleCountPattern = /(\\d+)ê°œ(?!\\s*[Ã—x])/i;\n      const singleCountMatch = packageInfo.match(singleCountPattern);\n      if (singleCountMatch) {\n        const count = parseInt(singleCountMatch[1]);\n        console.log(`ğŸ“¦ ê°œìˆ˜: ${count}ê°œ`);\n        return { totalAmount: count, unitType: 'ê°œ' };\n      }\n      \n      // 6ï¸âƒ£ \"2L\" ë¦¬í„° í˜•íƒœ\n      const literPattern = /(\\d+(?:\\.\\d+)?)L/i;\n      const literMatch = packageInfo.match(literPattern);\n      if (literMatch) {\n        const liters = parseFloat(literMatch[1]);\n        console.log(`ğŸ“¦ ë¦¬í„°: ${liters}L = ${liters * 1000}ml`);\n        return { totalAmount: liters * 1000, unitType: 'ml' };\n      }\n      \n      // 7ï¸âƒ£ \"500ml\" ë°€ë¦¬ë¦¬í„° í˜•íƒœ\n      const mlPattern = /(\\d+)ml/i;\n      const mlMatch = packageInfo.match(mlPattern);\n      if (mlMatch) {\n        const ml = parseInt(mlMatch[1]);\n        console.log(`ğŸ“¦ ë°€ë¦¬ë¦¬í„°: ${ml}ml`);\n        return { totalAmount: ml, unitType: 'ml' };\n      }\n      \n      console.warn(`âš ï¸ íŒ¨í‚¤ì§€ ì •ë³´ ë¶„ì„ ì‹¤íŒ¨: \"${packageInfo}\" - ê¸°ë³¸ê°’ ì‚¬ìš©`);\n      return { totalAmount: 100, unitType: 'g' }; // ê¸°ë³¸ê°’\n    };\n    \n    const packageAnalysis = analyzePackage(product.weight);\n    const packageTotalAmount = packageAnalysis.totalAmount;\n    const packageUnitType = packageAnalysis.unitType;\n    const recipeUsage = ingredient.quantity;\n    const recipeUnit = ingredient.unit;\n    \n    console.log(`ğŸ§® ê³„ì‚° ì¤‘: ${product.name}`);\n    console.log(`ğŸ“¦ íŒ¨í‚¤ì§€: ${packageTotalAmount}${packageUnitType}`);\n    console.log(`ğŸ¥„ ë ˆì‹œí”¼ ì‚¬ìš©ëŸ‰: ${recipeUsage}${recipeUnit}`);\n    \n    // ğŸ”¢ ë‹¨ìœ„ í†µì¼ í›„ ê³„ì‚°\n    let maxRecipesFromThisIngredient: number;\n    \n    if (recipeUnit === 'g' && (packageUnitType === 'g' || packageUnitType === 'ml')) {\n      // ê·¸ë¨ ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeUsage);\n    } else if (recipeUnit === 'ml' && packageUnitType === 'ml') {\n      // ë°€ë¦¬ë¦¬í„° ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeUsage);\n    } else if (recipeUnit === 'ê°œ' && packageUnitType === 'ê°œ') {\n      // ê°œìˆ˜ ë‹¨ìœ„: ì§ì ‘ ê³„ì‚° ê°€ëŠ¥\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeUsage);\n    } else if (recipeUnit === 'í°ìˆ ') {\n      // í°ìˆ  = ì•½ 15ml/15g\n      const recipeAmountInGrams = recipeUsage * 15;\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeAmountInGrams);\n    } else if (recipeUnit === 'ì‘ì€ìˆ ') {\n      // ì‘ì€ìˆ  = ì•½ 5ml/5g\n      const recipeAmountInGrams = recipeUsage * 5;\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeAmountInGrams);\n    } else if (recipeUnit === 'ì»µ') {\n      // ì»µ = ì•½ 200ml/200g\n      const recipeAmountInGrams = recipeUsage * 200;\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / recipeAmountInGrams);\n    } else {\n      // ê¸°íƒ€ ë‹¨ìœ„: ë³´ìˆ˜ì  ê³„ì‚°\n      console.warn(`âš ï¸ ë‹¨ìœ„ ë³€í™˜ ë¶ˆê°€: ${recipeUnit} â†” ${packageUnitType}`);\n      maxRecipesFromThisIngredient = Math.floor(packageTotalAmount / (recipeUsage * 10));\n    }\n    \n    // ğŸ›¡ï¸ 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€\n    if (maxRecipesFromThisIngredient <= 0) {\n      console.warn(`âš ï¸ ê³„ì‚° ê²°ê³¼ê°€ 0 ì´í•˜: ${product.name} - ìµœì†Œê°’ 1ë¡œ ì„¤ì •`);\n      maxRecipesFromThisIngredient = 1;\n    }\n    \n    const costPerRecipe = Math.round(product.price / maxRecipesFromThisIngredient);\n    \n    console.log(`âœ… ê²°ê³¼: ${maxRecipesFromThisIngredient}ë²ˆ ê°€ëŠ¥, 1íšŒë‹¹ ${costPerRecipe}ì›`);\n    \n    return {\n      productName: product.name,\n      productPackageSize: product.weight,\n      usagePerRecipe: `${recipeUsage}${recipeUnit}`,\n      maxRecipesFromThisIngredient: maxRecipesFromThisIngredient,\n      costPerRecipe: costPerRecipe,\n      totalProductCost: product.price\n    };\n  });\n  \n  // ğŸ¯ ë³‘ëª© ì¬ë£Œ ì°¾ê¸° (ê°€ì¥ ì ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ” íšŸìˆ˜)\n  const minPossibleRecipes = Math.min(...ingredientAnalysis.map(analysis => analysis.maxRecipesFromThisIngredient));\n  \n  // ğŸ“Š í‰ê·  ì œì¡° ê°€ëŠ¥ íšŸìˆ˜\n  const averageRecipesPerIngredient = Math.round(\n    ingredientAnalysis.reduce((sum, analysis) => sum + analysis.maxRecipesFromThisIngredient, 0) / ingredientAnalysis.length\n  );\n  \n  // ğŸ’° ë ˆì‹œí”¼ 1íšŒë‹¹ ì´ ë¹„ìš©\n  const totalCostPerRecipe = ingredientAnalysis.reduce((sum, analysis) => sum + analysis.costPerRecipe, 0);\n  \n  return {\n    recipeId,\n    recipeName: recipe?.name || 'ì•Œ ìˆ˜ ì—†ëŠ” ë ˆì‹œí”¼',\n    ingredientAnalysis,\n    minPossibleRecipes,\n    averageRecipesPerIngredient,\n    totalCostPerRecipe: Math.round(totalCostPerRecipe)\n  };\n};\n\n// ğŸ’° ì˜ˆì‚° ê¸°ë°˜ ë ˆì‹œí”¼ í•„í„°ë§ ë° ì¡°í•© ì„ íƒ\nconst getBudgetAwareRecipeCombination = (\n  goalRecipes: Recipe[], \n  monthlyBudget: number,\n  nutritionTargets: PersonalizedNutritionTargets\n): Recipe[] => {\n  // ê° ë ˆì‹œí”¼ì˜ ì›”ê°„ ë¹„ìš©ê³¼ ì˜ì–‘ê°€ ê³„ì‚°\n  const recipeAnalysis = goalRecipes.map(recipe => {\n    const monthlyCost = calculateRecipeMonthlyCost(recipe.id, 10); // í•œ ë‹¬ì— 10ë²ˆ í•´ë‹¹ ë ˆì‹œí”¼\n    const nutrition = calculateRecipeNutrition(recipe.id);\n    const nutritionScore = (nutrition.protein * 4 + nutrition.carb * 4 + nutrition.fat * 9) / monthlyCost; // ì›ë‹¹ ì˜ì–‘ê°€\n    \n    return {\n      recipe,\n      monthlyCost,\n      nutrition,\n      nutritionScore,\n      costPerCalorie: monthlyCost / (nutrition.calories || 1)\n    };\n  });\n\n  // ì˜ˆì‚° ë²”ìœ„ ë‚´ ë ˆì‹œí”¼ë“¤ë§Œ í•„í„°ë§\n  const affordableRecipes = recipeAnalysis.filter(analysis => \n    analysis.monthlyCost <= monthlyBudget * 0.4 // ë‹¨ì¼ ë ˆì‹œí”¼ê°€ ì˜ˆì‚°ì˜ 40%ë¥¼ ë„˜ì§€ ì•Šë„ë¡\n  );\n\n  if (affordableRecipes.length === 0) {\n    // ì˜ˆì‚°ì´ ë„ˆë¬´ ì ìœ¼ë©´ ê°€ì¥ ì €ë ´í•œ ë ˆì‹œí”¼ë“¤ ì„ íƒ\n    const sortedByCost = recipeAnalysis.sort((a, b) => a.monthlyCost - b.monthlyCost);\n    return sortedByCost.slice(0, 3).map(analysis => analysis.recipe);\n  }\n\n  // ğŸ¯ ìµœì  ì¡°í•© ì°¾ê¸° (ì˜ˆì‚° ë‚´ì—ì„œ ì˜ì–‘ê°€ ìµœëŒ€í™”) - ì„±ëŠ¥ ìµœì í™”\n  const findOptimalCombination = (): Recipe[] => {\n    const combinations: Recipe[][] = [];\n    const maxCombinations = 1000; // ì¡°í•© ìˆ˜ ì œí•œìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ\n    \n    // ê°€ê²© ê¸°ì¤€ ì‚¬ì „ ì •ë ¬ë¡œ ì¡°ê¸° ì¢…ë£Œ ìµœì í™”\n    const sortedByPrice = affordableRecipes.sort((a, b) => a.monthlyCost - b.monthlyCost);\n    \n    // ì•„ì¹¨, ì ì‹¬, ì €ë…ìš© ë ˆì‹œí”¼ë¥¼ ê°ê° ì„ íƒ (ìµœì í™”ëœ ë£¨í”„)\n    outerLoop: for (let i = 0; i < sortedByPrice.length && combinations.length < maxCombinations; i++) {\n      const breakfast = sortedByPrice[i];\n      \n      for (let j = 0; j < sortedByPrice.length && combinations.length < maxCombinations; j++) {\n        const lunch = sortedByPrice[j];\n        \n        // ì¡°ê¸° ì¢…ë£Œ ì¡°ê±´ (2ê°œ í•©ê³„ê°€ ì´ë¯¸ ì˜ˆì‚° ì´ˆê³¼)\n        if (breakfast.monthlyCost + lunch.monthlyCost > monthlyBudget * 0.9) {\n          continue;\n        }\n        \n        for (let k = 0; k < sortedByPrice.length && combinations.length < maxCombinations; k++) {\n          const dinner = sortedByPrice[k];\n          const totalCost = breakfast.monthlyCost + lunch.monthlyCost + dinner.monthlyCost;\n          \n          if (totalCost <= monthlyBudget) {\n            combinations.push([breakfast.recipe, lunch.recipe, dinner.recipe]);\n          } else {\n            // ê°€ê²©ìˆœ ì •ë ¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë” ì´ìƒ í™•ì¸ ë¶ˆí•„ìš”\n            break;\n          }\n        }\n      }\n    }\n\n    if (combinations.length === 0) {\n      // 3ê°œ ì¡°í•©ì´ ë¶ˆê°€ëŠ¥í•˜ë©´ ê°€ì¥ ì €ë ´í•œ 2ê°œ ì„ íƒ\n      const sortedByCost = affordableRecipes.sort((a, b) => a.monthlyCost - b.monthlyCost);\n      return sortedByCost.slice(0, 2).map(analysis => analysis.recipe);\n    }\n\n    // ì˜ì–‘ê°€ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ ì¡°í•© ì„ íƒ\n    let bestCombination = combinations[0];\n    let bestScore = 0;\n\n    combinations.forEach(combination => {\n      const totalNutrition = combination.reduce((sum, recipe) => {\n        const nutrition = calculateRecipeNutrition(recipe.id);\n        return {\n          calories: sum.calories + nutrition.calories,\n          protein: sum.protein + nutrition.protein,\n          carb: sum.carb + nutrition.carb,\n          fat: sum.fat + nutrition.fat\n        };\n      }, { calories: 0, protein: 0, carb: 0, fat: 0 });\n\n      // ëª©í‘œ ì˜ì–‘ì†Œì™€ì˜ ê·¼ì‚¬ë„ ì ìˆ˜\n      const calorieScore = 100 - Math.abs(totalNutrition.calories - nutritionTargets.targetCalories) / nutritionTargets.targetCalories * 100;\n      const proteinScore = 100 - Math.abs(totalNutrition.protein - nutritionTargets.macroGrams.protein) / nutritionTargets.macroGrams.protein * 100;\n      \n      const combinationScore = Math.max(0, calorieScore) + Math.max(0, proteinScore);\n\n      if (combinationScore > bestScore) {\n        bestScore = combinationScore;\n        bestCombination = combination;\n      }\n    });\n\n    return bestCombination;\n  };\n\n  return findOptimalCombination();\n};\n\n// ğŸ¯ ì „ì²´ ê°œì¸í™” ì¶”ì²œ í†µí•© í•¨ìˆ˜\nexport const generatePersonalizedRecommendations = (\n  userProfile: UserProfile,\n  calorieCalculation: CalorieCalculation,\n  preferences?: PersonalizedContext['preferences'],\n  history?: PersonalizedContext['history']\n) => {\n  const context: PersonalizedContext = {\n    userProfile,\n    calorieCalculation,\n    currentTime: new Date(),\n    preferences,\n    history\n  };\n\n  const nutritionTargets = calculatePersonalizedNutritionTargets(userProfile, calorieCalculation);\n  const recommendedProducts = getPersonalizedProductRecommendations(context);\n  const recommendedRecipes = getPersonalizedRecipeRecommendations(context);\n\n  // ê°œì¸í™” ë©”ì‹œì§€ ìƒì„±\n  const personalizedMessage = generatePersonalizedMessage(userProfile, nutritionTargets);\n\n  return {\n    nutritionTargets,\n    recommendedProducts,\n    recommendedRecipes,\n    personalizedMessage,\n    context\n  };\n};\n\n// ğŸ’° ì˜ˆì‚° ê³ ë ¤ ê°œì¸í™” ì¶”ì²œ í•¨ìˆ˜ (ë©”ì¸)\nexport const generateBudgetAwareRecommendations = async (\n  userProfile: UserProfile,\n  calorieCalculation: CalorieCalculation,\n  monthlyBudget: number,\n  preferences?: PersonalizedContext['preferences'],\n  history?: PersonalizedContext['history']\n): Promise<{\n  personalizedMessage: string;\n  nutritionTargets: PersonalizedNutritionTargets;\n  recommendedProducts: CoupangProduct[];\n  recommendedRecipes: Recipe[];\n  budgetAnalysis: {\n    totalEstimatedCost: number;\n    budgetUsagePercentage: number;\n    costBreakdown: Array<{\n      recipeId: string;\n      recipeName: string;\n      monthlyCost: number;\n      costPercentage: number;\n    }>;\n  };\n  context: PersonalizedContext;\n}> => {\n  const context: PersonalizedContext = {\n    userProfile,\n    calorieCalculation,\n    currentTime: new Date(),\n    preferences,\n    history\n  };\n\n  const nutritionTargets = calculatePersonalizedNutritionTargets(userProfile, calorieCalculation);\n  \n  // ğŸ¯ ëª©í‘œì— ë§ëŠ” ëª¨ë“  ë ˆì‹œí”¼ ê°€ì ¸ì˜¤ê¸° (ë¹„ë™ê¸°)\n  const goalRecipes = await getRecipesByGoal(userProfile.goal || 'maintenance');\n  \n  // ğŸ’° ì˜ˆì‚° ê¸°ë°˜ ìµœì  ë ˆì‹œí”¼ ì¡°í•© ì„ íƒ\n  const budgetOptimizedRecipes = getBudgetAwareRecipeCombination(\n    goalRecipes, \n    monthlyBudget, \n    nutritionTargets\n  );\n\n  // ğŸ“Š ì˜ˆì‚° ë¶„ì„\n  const costBreakdown = budgetOptimizedRecipes.map(recipe => {\n    const monthlyCost = calculateRecipeMonthlyCost(recipe.id, 10);\n    return {\n      recipeId: recipe.id,\n      recipeName: recipe.name,\n      monthlyCost,\n      costPercentage: (monthlyCost / monthlyBudget) * 100\n    };\n  });\n\n  const totalEstimatedCost = costBreakdown.reduce((sum, item) => sum + item.monthlyCost, 0);\n  const budgetUsagePercentage = (totalEstimatedCost / monthlyBudget) * 100;\n\n  // ì œí’ˆ ì¶”ì²œì€ ê¸°ì¡´ ë¡œì§ í™œìš©\n  const recommendedProducts = getPersonalizedProductRecommendations(context);\n\n  // ğŸ’¬ ì˜ˆì‚° ê³ ë ¤ ë©”ì‹œì§€ ìƒì„±\n  const personalizedMessage = generateBudgetAwareMessage(\n    userProfile, \n    nutritionTargets, \n    monthlyBudget, \n    totalEstimatedCost\n  );\n\n  return {\n    personalizedMessage,\n    nutritionTargets,\n    recommendedProducts,\n    recommendedRecipes: budgetOptimizedRecipes,\n    budgetAnalysis: {\n      totalEstimatedCost,\n      budgetUsagePercentage,\n      costBreakdown\n    },\n    context\n  };\n};\n\n// ğŸ’¬ ê°œì¸í™” ë©”ì‹œì§€ ìƒì„±\nconst generatePersonalizedMessage = (\n  userProfile: UserProfile,\n  targets: ReturnType<typeof calculatePersonalizedNutritionTargets>\n): string => {\n  const { goal, gender, age, weight } = userProfile;\n  const { targetCalories, dailyProteinNeeds } = targets;\n\n  const goalMessages = {\n    weight_loss: `${gender === 'male' ? 'í˜•' : 'ë‹˜'}ì˜ ë‹¤ì´ì–´íŠ¸ ì„±ê³µì„ ìœ„í•´ ì¼ì¼ ${targetCalories}kcal, ë‹¨ë°±ì§ˆ ${Math.round(dailyProteinNeeds)}g ëª©í‘œë¡œ ë§ì¶¤ ì‹ë‹¨ì„ ì¤€ë¹„í–ˆì–´ìš”! ğŸ’ª`,\n    muscle_gain: `${age}ì„¸ ${gender === 'male' ? 'í˜•' : 'ë‹˜'}ì˜ ê·¼ì„±ì¥ì„ ìœ„í•´ ì¼ì¼ ${targetCalories}kcal, ê³ ë‹¨ë°± ${Math.round(dailyProteinNeeds)}g ì‹ë‹¨ìœ¼ë¡œ êµ¬ì„±í–ˆì–´ìš”! ğŸ”¥`, \n    maintenance: `${weight}kg ê±´ê°• ìœ ì§€ë¥¼ ìœ„í•´ ì¼ì¼ ${targetCalories}kcal ê· í˜• ì¡íŒ ì‹ë‹¨ì„ ì¶”ì²œë“œë ¤ìš”! âš–ï¸`\n  };\n\n  return goalMessages[goal] || 'ë§ì¶¤í˜• ì‹ë‹¨ì„ ì¤€ë¹„í–ˆì–´ìš”! ğŸ¯';\n};\n\n// ğŸ’° ì˜ˆì‚° ê³ ë ¤ ë©”ì‹œì§€ ìƒì„±\nconst generateBudgetAwareMessage = (\n  userProfile: UserProfile,\n  targets: ReturnType<typeof calculatePersonalizedNutritionTargets>,\n  monthlyBudget: number,\n  estimatedCost: number\n): string => {\n  const { goal, gender } = userProfile;\n  const { targetCalories, dailyProteinNeeds } = targets;\n  const savings = monthlyBudget - estimatedCost;\n  const usagePercentage = (estimatedCost / monthlyBudget) * 100;\n\n  const baseMessage = `${gender === 'male' ? 'í˜•' : 'ë‹˜'}ì˜ ${goal === 'weight_loss' ? 'ë‹¤ì´ì–´íŠ¸' : goal === 'muscle_gain' ? 'ê·¼ì„±ì¥' : 'ê±´ê°•ìœ ì§€'} ëª©í‘œì— ë§ì¶°`;\n\n  if (usagePercentage <= 70) {\n    return `${baseMessage} ì˜ˆì‚°ì„ ì•Œëœ°í•˜ê²Œ í™œìš©í•œ ì‹ë‹¨ì„ ì¤€ë¹„í–ˆì–´ìš”! ğŸ’° ì›” ${estimatedCost.toLocaleString()}ì›ìœ¼ë¡œ ëª©í‘œ ë‹¬ì„±ì´ ê°€ëŠ¥í•´ìš” (${savings.toLocaleString()}ì› ì ˆì•½!) ğŸ¯`;\n  } else if (usagePercentage <= 90) {\n    return `${baseMessage} ì˜ˆì‚°ì— ë”± ë§ëŠ” íš¨ìœ¨ì ì¸ ì‹ë‹¨ì„ êµ¬ì„±í–ˆì–´ìš”! ğŸ’ª ì›” ${estimatedCost.toLocaleString()}ì›ìœ¼ë¡œ ëª©í‘œ ì˜ì–‘ì†Œë¥¼ ì¶©ì¡±í•  ìˆ˜ ìˆì–´ìš”! ğŸ¯`;\n  } else {\n    return `${baseMessage} ì˜ˆì‚°ì„ ìµœëŒ€í•œ í™œìš©í•œ ê°€ì„±ë¹„ ìµœê³ ì˜ ì‹ë‹¨ì´ì—ìš”! ğŸ’¯ ì›” ${estimatedCost.toLocaleString()}ì›ìœ¼ë¡œ ìµœê³ ì˜ ì˜ì–‘ íš¨ê³¼ë¥¼ ì–»ìœ¼ì„¸ìš”! ğŸ”¥`;\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}